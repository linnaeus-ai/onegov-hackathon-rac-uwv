erDiagram

    NatuurlijkPersoon {
        string identificatie PK
        date geboortedatum
        int leeftijd
        string burgerservicenummer
        boolean isAOWGerechtigd
        boolean isAlleenstaand
        decimal aowOpbouwpercentage
    }

    Huishouden {
        string identificatie PK
        enum huishoudtype
        int aantalMinderjarigen
    }

    Verblijfsobject {
        string identificatie PK
        enum woningtype
        decimal huurprijs
        decimal wozWaarde
    }

    Pensioenuitvoerder {
        string identificatie PK
        string naam
        string uitvoerdertype
    }

    Pensioenaanspraak {
        string identificatie PK
        decimal maandelijksBedrag
        decimal jaarlijksBedrag
        decimal gekapitaliseerdeWaarde
        date ingangsdatum
        boolean isVerevend
    }

    Partner {
        string identificatie PK
        boolean isToeslagpartner
        decimal inkomen
    }

    Pensioenverevening {
        string identificatie PK
        decimal verevendPercentage
        boolean isToestemmingVerkregen
    }

    BedragIneensKeuze {
        string identificatie PK
        int opnamepercentage
        boolean kiestUitgesteldeBetaling
        date keuzedatum
        boolean isOnherroepelijk
    }

    UitgesteldeBetaling {
        string identificatie PK
        boolean isEligible
        date geplandeBetaaldatum
        date pensioenverlagingsdatum
    }

    Geschiktheidsbeoordeling {
        string identificatie PK
        boolean isOpIngangsdatum
        boolean isNietEerderGekozen
        boolean isMinimumPensioenOk
        boolean isPartnerToestemmingOk
        boolean isGeenHoogLaag
        decimal minimumRestbedrag
    }

    Berekeningsscenario {
        string identificatie PK
        int opnamepercentage
        enum scenariotype
    }

    BedragIneensResultaat {
        string identificatie PK
        decimal brutoBedragIneens
        decimal verlaagdPensioenMaand
        decimal verlaagdPensioenJaar
        decimal permanentVerlies
    }

    Inkomensjaar {
        string identificatie PK
        enum jaartype
        decimal aowUitkering
        decimal aanvullendPensioen
        decimal bedragIneens
        decimal overigInkomen
        decimal brutoInkomen
        decimal toetsingsinkomen
    }

    Belastingaanslag {
        string identificatie PK
        decimal belastingBox1Bruto
        decimal zvwBijdrage
        decimal totaleHeffingskortingen
        decimal belastingNaKortingen
        decimal nettoInkomen
    }

    Heffingskorting {
        string identificatie PK
        enum kortingtype
        decimal maximaalBedrag
        decimal berekendBedrag
        boolean isVolledigToegepast
    }

    Toeslag {
        string identificatie PK
        enum toeslagtype
        decimal bedragZonderOpname
        decimal bedragMetOpname
        decimal verlies
        boolean vervaltVolledig
    }

    BijzondereNabetaling {
        string identificatie PK
        boolean isAangevraagd
        boolean isGoedgekeurd
    }

    Parameterset {
        string identificatie PK
        int belastingjaar
        date geldigVanaf
        date geldigTot
    }

    Belastingtarief {
        string identificatie PK
        decimal schijf1Grens
        decimal schijf2Grens
        decimal tariefSchijf1AOW
        decimal tariefSchijf1NietAOW
        decimal tariefSchijf2
        decimal tariefSchijf3
    }

    HeffingskortingBedrag {
        string identificatie PK
        enum kortingtype
        decimal maximaalBedrag
        decimal afbouwgrens
        decimal afbouwpercentage
        decimal afbouweindgrens
    }

    ZvwTarief {
        string identificatie PK
        decimal bijdragepercentage
        decimal maximaleGrondslag
    }

    Toeslaggrens {
        string identificatie PK
        enum toeslagtype
        decimal inkomensgrensAlleenstaand
        decimal inkomensgrensPartners
        decimal vermogensgrensAlleenstaand
        decimal vermogensgrensPartners
        decimal maximaalBedrag
    }

    AOWBedrag {
        string identificatie PK
        decimal brutoAlleenstaand
        decimal brutoPartners
        int aowLeeftijd
    }

    Risicoprofiel {
        string identificatie PK
        boolean isToeslagafhankelijk
        boolean heeftSchulden
        boolean heeftLaagInkomen
        enum risicocategorie
    }

    Signalering {
        string identificatie PK
        enum ernst
        string code
        string titel
        string bericht
        string wettelijkeBasis
    }

    Scenariovergelijking {
        string identificatie PK
        int aanbevolenPercentage
        string aanbevelingsreden
    }

    NatuurlijkPersoon ||--|| Huishouden : "behoort tot"
    NatuurlijkPersoon ||--o| Verblijfsobject : "heeft als verblijfsobject"
    NatuurlijkPersoon ||--o| Partner : "heeft als partner"
    NatuurlijkPersoon ||--|{ Pensioenaanspraak : "heeft aanspraak op"
    NatuurlijkPersoon ||--o{ Pensioenverevening : "heeft verevening met"
    NatuurlijkPersoon ||--o{ BedragIneensKeuze : "maakt keuze voor"
    NatuurlijkPersoon ||--|{ Berekeningsscenario : "heeft scenario"
    NatuurlijkPersoon ||--|| Risicoprofiel : "heeft profiel"

    Pensioenaanspraak }|--|| Pensioenuitvoerder : "is ondergebracht bij"
    Pensioenaanspraak ||--o| Pensioenverevening : "is verevend via"

    BedragIneensKeuze ||--o| UitgesteldeBetaling : "heeft optie voor"
    BedragIneensKeuze ||--|| Geschiktheidsbeoordeling : "is beoordeeld door"

    Berekeningsscenario ||--|| BedragIneensResultaat : "resulteert in"
    Berekeningsscenario ||--|{ Inkomensjaar : "bevat inkomen voor"
    Berekeningsscenario ||--|{ Toeslag : "bevat toeslag"
    Berekeningsscenario ||--o{ Signalering : "genereert"

    Inkomensjaar ||--|| Belastingaanslag : "leidt tot"
    Belastingaanslag ||--|{ Heffingskorting : "bevat korting"

    Toeslag ||--o| BijzondereNabetaling : "heeft uitzondering"

    Parameterset ||--|{ Belastingtarief : "definieert"
    Parameterset ||--|{ HeffingskortingBedrag : "definieert"
    Parameterset ||--|{ ZvwTarief : "definieert"
    Parameterset ||--|{ Toeslaggrens : "definieert"
    Parameterset ||--|{ AOWBedrag : "definieert"

    Scenariovergelijking ||--|| NatuurlijkPersoon : "is opgesteld voor"
    Scenariovergelijking ||--|{ Berekeningsscenario : "vergelijkt"
